## ğŸ§° **OperaÃ§Ãµes e Infraestrutura (Deploy e DevOps)**

Este documento descreve como o ambiente serÃ¡ configurado, como o deploy serÃ¡ feito e boas prÃ¡ticas operacionais para manter a plataforma estÃ¡vel, segura e escalÃ¡vel.

---

### 1. ğŸ—ï¸ Ambiente de Desenvolvimento

#### Ferramentas

* Docker Compose com os seguintes serviÃ§os:

  * `api`: Django + Gunicorn
  * `db`: PostgreSQL 15
  * `nginx`: Servidor reverso
  * (futuro) `celery` + `redis` para tarefas assÃ­ncronas

#### Comandos de uso comum

```bash
docker-compose up -d --build
docker-compose exec web python manage.py migrate
docker-compose exec web python manage.py createsuperuser
```

#### VariÃ¡veis de Ambiente (.env)

```
DEBUG=True
SECRET_KEY=...
DATABASE_URL=postgres://user:pass@db:5432/dbname
CLOUDINARY_URL=...
STRIPE_API_KEY=...
```

---

### 2. ğŸš€ Deploy em ProduÃ§Ã£o (VPS com Docker)

#### Requisitos do Servidor

* Ubuntu 22.04+
* Docker 24+
* Docker Compose v2
* Firewall (UFW ou iptables) configurado

#### Stack

* NGINX como proxy reverso (porta 80/443)
* Gunicorn como servidor WSGI
* PostgreSQL local ou serviÃ§o gerenciado (ex: Supabase, NeonDB)
* Certificados HTTPS com Letâ€™s Encrypt (via Certbot)

#### EstratÃ©gia

* Deploy via Git + `docker-compose.prod.yml`
* CI/CD opcional via GitHub Actions:

  * Push â†’ build docker image â†’ deploy via SSH

---

### 3. ğŸ“‚ Estrutura de Deploy

```
/app
â”œâ”€â”€ docker/
â”‚   â”œâ”€â”€ nginx/
â”‚   â”œâ”€â”€ django/
â”‚   â””â”€â”€ postgres/
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ docker-compose.prod.yml
â”œâ”€â”€ .env
```

---

### 4. ğŸ”’ SeguranÃ§a Operacional

| Item                    | Medida                                       |
| ----------------------- | -------------------------------------------- |
| VariÃ¡veis secretas      | Armazenadas em `.env`, nunca versionadas     |
| Login/admin             | Protegido por `TokenAuthentication` e roles      |
| Headers de seguranÃ§a    | Configurados no NGINX (`X-Frame`, CSP, etc.) |
| Backup de banco         | Script programado (via cron/docker-volume)   |
| AtualizaÃ§Ãµes de pacotes | Manuais semanais com `apt upgrade`           |
| TLS                     | Certbot com auto-renovaÃ§Ã£o                   |

---

### 5. ğŸ“ˆ Monitoramento e Logs

* **Logs:** direcionados para `stdout` (Docker logging)
* **Monitoramento bÃ¡sico:** UptimeRobot (endpoint health checks)
* **Escalabilidade futura:**

  * Deploy com autoscaling (Render, Railway ou ECS)
  * Redis para cache de pÃ¡ginas e sessÃµes

---

### 6. â˜ï¸ ServiÃ§os de Terceiros

| ServiÃ§o       | Uso                                     |
| ------------- | --------------------------------------- |
| Cloudinary    | Upload e CDN de mÃ­dia                   |
| Stripe        | Checkout e controle de acesso futuro    |
| GitHub        | RepositÃ³rio privado + CI/CD via Actions |
| Mail (futuro) | SMTP para notificaÃ§Ãµes                  |
